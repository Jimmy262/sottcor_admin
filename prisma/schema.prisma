// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Tabla de mensajes entrantes por inbox
model IncomingMessage {
  id           BigInt   @id @default(autoincrement())
  inbox_id     Int
  message_text String   @db.Text
  created_at   DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  weights      IncomingMessageWeight[]

  @@unique([inbox_id, message_text])
  @@map("incoming_messages")
}

// Tabla de pesos asignados por mensaje y usuario
model IncomingMessageWeight {
  id                   BigInt   @id @default(autoincrement())
  id_incoming_message  BigInt
  user_id              BigInt
  peso                 Int      @default(0)

  incoming_message     IncomingMessage @relation(fields: [id_incoming_message], references: [id], onDelete: Cascade)

  @@map("incoming_message_weights")
}

// Modelo para consultar inboxes existentes (solo lectura)
model Inbox {
  id   Int    @id
  name String

  @@map("inboxes")
}

// Modelo para consultar usuarios existentes (solo lectura)
model User {
  id    BigInt @id
  name  String
  email String?

  @@map("users")
}
